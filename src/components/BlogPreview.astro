---
import {
    getLangFromUrl,
    useTranslatedPath,
    formatDateRespectingLang,
} from "@i18n/utils"

const lang = getLangFromUrl(Astro.url)
const translatePath = useTranslatedPath(lang)

import Pill from "@components/Pill.astro"
import type { CollectionEntry } from "astro:content"
import { Image } from "astro:assets"

interface Props {
    post: CollectionEntry<"blog">
}

const { data, slug } = Astro.props.post
---

<article
    class="group mx-auto w-full max-w-md overflow-hidden rounded-lg shadow transition hover:shadow-lg md:max-w-none"
>
    <a href={translatePath(`/blog/${slug}`)}>
        <Image
            src={data.img}
            alt={data.img_alt}
            height={254}
            class="aspect-[2] w-full bg-gray-100 object-cover"
        />
        <div class="p-4 sm:p-6">
            <div class="flex flex-wrap items-center gap-4 text-xs">
                <time
                    datetime={data.publishDate.toISOString().split("T")[0]}
                    class="text-gray-500"
                    >{formatDateRespectingLang(data.publishDate, lang)}</time
                >
                <div class="flex flex-wrap items-start">
                    {
                        data.categories.map((tag) => (
                            <Pill
                                size="xs"
                                class="bg-gray-50 text-gray-600"
                                noColor={true}
                            >
                                {tag}
                            </Pill>
                        ))
                    }
                </div>
            </div>
            <div class="relative flex-grow">
                <h3
                    class="mt-2 max-w-fit text-lg leading-6 text-gray-900 group-hover:text-gray-600"
                >
                    {data.title}
                </h3>
                <p
                    class="mt-2 line-clamp-3 font-sans text-sm/relaxed text-gray-600"
                >
                    {data.description}
                </p>
            </div>
        </div>
    </a>
</article>
